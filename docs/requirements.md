# NewsHub 需求文档

## 1. 项目概述

### 1.1 项目背景
在信息爆炸的时代，用户需要访问多个平台才能获取全面的热点信息。NewsHub 旨在通过集成 hot_news API，聚合22个主流平台的实时热点数据，为用户提供一个集中、高效的热点新闻浏览平台。

### 1.2 项目目标
- 聚合22个主流平台的热点内容（百度、微博、知乎、36氪等）
- 提供实时的热点发现和排序
- 打造流畅的新闻浏览体验
- 支持按平台和分类浏览
- 零爬虫维护，使用第三方API获取数据

## 2. 功能需求

### 2.1 平台数据源管理

#### 2.1.1 数据源接入
- 使用 hot_news API 获取数据（API 地址：https://orz.ai/api/v1/dailynews/）
- 支持22个平台的数据获取：
  - **社交媒体**：微博、知乎、抖音、豆瓣、哔哩哔哩
  - **科技媒体**：36氪、少数派、掘金、V2EX、GitHub Trending、Stack Overflow、Hacker News、吾爱破解
  - **财经媒体**：新浪财经、东方财富、雪球、财联社
  - **综合媒体**：百度、今日头条、腾讯网
  - **其他**：虎扑、百度贴吧
- 数据每30分钟自动刷新一次
- 可配置的平台启用/禁用状态

#### 2.1.2 平台配置
- 管理员可启用/禁用特定平台
- 支持配置平台的优先级和展示顺序
- 支持按分类组织平台（社交、科技、财经等）

### 2.2 数据获取与处理

#### 2.2.1 API数据获取
- 通过 HTTP GET 请求调用 hot_news API
- 按平台代码获取数据（如：?platform=baidu）
- 提取返回的数据字段：
  - 标题
  - URL 链接
  - 热度评分
  - 描述信息（如有）
- 支持22个平台的批量获取

#### 2.2.2 数据清洗
- 去除重复内容（基于 URL 或标题相似度）
- 过滤无效或异常数据
- 内容格式标准化
- URL 合法性验证
- 敏感词过滤（可选）

#### 2.2.3 内容存储
- 热点新闻元数据存储
- 历史数据归档（按快照日期）
- 支持全文索引
- 数据快照和版本管理

### 2.3 热点算法与排序

#### 2.3.1 热度计算
基于 hot_news API 返回的 score 字段进行热度计算：
- 直接使用 API 返回的热度评分
- 可结合平台权重调整（不同平台设置不同权重）
- 可结合时间衰减因子（新内容适当加权）
- 综合评分计算：`final_score = api_score * platform_weight * time_factor`

#### 2.3.2 排序策略
- 按热度排序（使用 API score）
- 按平台排序（按平台分类浏览）
- 按时间排序（快照时间）
- 混合排序（热度 + 时间 + 平台权重）

### 2.4 分类与标签

#### 2.4.1 平台分类
支持按平台类型分类：
- 社交媒体（微博、知乎、抖音、豆瓣、哔哩哔哩）
- 科技媒体（36氪、少数派、掘金、V2EX、GitHub Trending 等）
- 财经媒体（新浪财经、东方财富、雪球、财联社）
- 综合媒体（百度、今日头条、腾讯网）
- 其他（虎扑、百度贴吧）

#### 2.4.2 标签系统
- 基于标题的关键词提取
- 手动标签管理
- 标签关联推荐
- 热门标签展示
- 平台作为默认标签

### 2.5 搜索功能

#### 2.5.1 基础搜索
- 关键词搜索
- 搜索范围：标题、描述
- 搜索结果高亮

#### 2.5.2 高级搜索
- 按平台筛选（支持多选）
- 按平台分类筛选（社交、科技、财经等）
- 按时间范围筛选
- 按热度范围筛选
- 组合条件搜索

#### 2.5.3 搜索体验
- 搜索建议/自动补全
- 搜索历史记录
- 热门搜索词（基于高频查询）

### 2.6 新闻展示

#### 2.6.1 首页
- 热点新闻轮播（跨平台 Top 10）
- 平台导航（22个平台入口）
- 热门新闻列表（按热度排序）
- 最新更新列表（按时间排序）
- 平台分类入口

#### 2.6.2 新闻列表
- 列表视图（紧凑，显示标题、热度、平台）
- 卡片视图（图文，带描述）
- 无限滚动加载
- 分页加载
- 按平台筛选视图

#### 2.6.3 新闻详情
- 标题和元信息（平台、热度、排名）
- 描述信息（如有）
- 原文链接（跳转至原始平台）
- 相关热点推荐
- 分享功能
- 历史趋势（该热点在不同时间快照的排名变化）

### 2.7 用户功能（可选）

#### 2.7.1 个性化推荐
- 基于浏览历史的平台推荐
- 基于兴趣标签的内容推荐
- 可调整平台偏好（优先显示哪些平台）

#### 2.7.2 收藏与关注
- 收藏热点新闻
- 关注平台
- 关注关键词

#### 2.7.3 用户账户
- 注册/登录
- 个人资料管理
- 浏览历史

### 2.8 管理后台

#### 2.8.1 仪表盘
- 热点数量统计
- API 调用状态监控
- 热门新闻分析
- 用户访问统计
- 平台数据分布

#### 2.8.2 内容管理
- 热点新闻列表管理
- 删除/隐藏热点
- 批量操作

#### 2.8.3 平台管理
- 启用/禁用平台
- 配置平台权重
- 调整平台分类
- 查看 API 调用日志

## 3. 非功能需求

### 3.1 性能要求

#### 3.1.1 响应时间
- 首页加载时间：< 2 秒
- 新闻列表加载：< 1 秒
- 搜索响应时间：< 1 秒
- 新闻详情加载：< 1.5 秒

#### 3.1.2 并发能力
- 支持 1000+ 并发用户
- 峰值时自动扩容

#### 3.1.3 数据更新
- 新闻抓取频率：可配置（5-30 分钟）
- 热度计算：实时/定时（每 5 分钟）

### 3.2 可用性要求
- 系统可用性：99.5%
- 计划内维护提前通知
- 优雅的错误处理

### 3.3 可扩展性
- 模块化设计，便于添加新功能
- 支持横向扩展
- 支持添加新的新闻源（无需代码修改）

### 3.4 兼容性
- 浏览器支持：Chrome, Firefox, Safari, Edge（最新两个版本）
- 移动端适配：iOS 12+, Android 8+
- 屏幕分辨率：320px - 4K

### 3.5 安全性
- 防 SQL 注入
- 防 XSS 攻击
- 防 CSRF 攻击
- API 访问频率限制
- 敏感数据加密存储
- HTTPS 加密传输

### 3.6 可维护性
- 清晰的代码结构
- 完善的注释文档
- 统一的代码风格
- 自动化测试覆盖

## 4. 用户角色

### 4.1 普通用户
- 浏览新闻
- 搜索新闻
- 按分类查看
- 查看新闻详情
- 可选：个性化设置

### 4.2 管理员
- 配置新闻源
- 管理新闻内容
- 查看统计数据
- 管理用户账户
- 系统设置

### 4.3 爬虫系统
- 自动抓取新闻
- 数据清洗和处理
- 热度计算
- 定时任务调度

## 5. 数据流

### 5.1 数据获取流程
```
定时任务触发（每30分钟）
    ↓
遍历22个平台
    ↓
调用 hot_news API
    ↓
接收 JSON 数据
    ↓
数据清洗和去重
    ↓
存储到数据库
    ↓
更新缓存和索引
```

### 5.2 用户访问流程
```
用户请求
    ↓
CDN 缓存检查（如有）
    ↓
Redis 缓存查询
    ↓
数据库查询（缓存未命中）
    ↓
结果聚合和排序
    ↓
返回展示
```

## 6. 约束与限制

### 6.1 法律法规
- 遵守《网络安全法》
- 遵守版权法，注明数据来源
- 跳转至原始平台时需遵循原平台的使用条款
- 用户协议和免责声明

### 6.2 技术约束
- API 调用频率：虽然 hot_news API 目前无明确限制，但建议合理控制请求频率
- API 可用性依赖：依赖第三方服务的可用性
- 网络超时处理：需要合理的超时和重试机制
- 数据格式限制：只能获取 API 提供的字段（标题、URL、评分、描述）
- 无法获取完整正文：数据仅包含热点标题和描述，正文需跳转至原平台查看

## 7. 未来规划

### 7.1 短期目标（3 个月）
- 完成基础功能开发
- 集成 hot_news API
- 接入全部22个平台
- 发布 Beta 版本

### 7.2 中期目标（6-12 个月）
- 优化热度算法和排序策略
- 增加个性化推荐功能
- 移动端 App 开发
- 用户社区功能
- 数据趋势分析

### 7.3 长期目标（1 年以上）
- AI 驱动的智能推荐
- 扩展其他数据源（不依赖单一 API）
- 多语言支持
- 国际化扩展
- 数据可视化大屏

## 8. 风险与挑战

### 8.1 技术风险
- API 服务不可用：hot_news API 可能因维护、更新或停止服务导致数据获取失败
- API 数据格式变更：API 响应格式可能发生变化，需要适配
- 网络问题：API 调用可能因网络问题超时或失败

### 8.2 法律风险
- 版权问题：仅聚合热点标题和链接，跳转至原平台查看详情，降低版权风险
- 数据合规性：确保数据使用符合相关法律法规

### 8.3 应对措施
- API 健康监控：实时监控 API 可用性，及时发现问题
- 降级策略：API 不可用时展示缓存的历史数据
- 多数据源备份：未来可考虑集成其他类似 API 服务
- 数据缓存：使用 Redis 缓存 API 数据，减少直接依赖
- 错误处理和重试：实现完善的错误处理和自动重试机制
- 用户协议和免责声明：明确说明数据来源和使用限制

---

**文档版本：** v2.0
**最后更新：** 2025-12-28
**维护者：** NewsHub Team
**变更说明：** 将数据获取方式从自建爬虫改为使用 hot_news API
